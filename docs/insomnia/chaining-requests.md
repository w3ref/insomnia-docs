---
layout: article-detail
title:  Цепочка запросов
category: "Запросы и ответы"
category-url: requests-and-responses
---

Insomnia дает возможность извлекать значения из ответов на другие запросы. Это обычно называется цепочкой, потому что зависимость от другого запроса формирует ссылку.

Поначалу может быть трудно понять цепочку запросов, особенно если понятия [Теги шаблона](/insomnia/template-tags) или [Переменные среды](/insomnia/environment-variables) незнакомы. Я предлагаю сначала взглянуть на них, если у вас возникли проблемы с началом работы.

Во-первых, давайте рассмотрим несколько примеров, для которых может быть полезно объединение в цепочку.

## Обычное использование

Чтобы помочь объяснить формирование цепочки запросов, вот несколько распространенных случаев использования:

* использовать токен из ответа на вход в качестве заголовка авторизации
* использовать идентификатор из POST `/item in PUT /items/<id>`
* использовать все тело из одного ответа для загрузки в другой

Есть много других способов использования цепочек, но это наиболее часто используемые примеры.

## Основы цепочки

Для начала выберите один из трех тегов ответа в раскрывающемся списке автозаполнения. Вы можете вызвать раскрывающийся список, нажав CTRL+Space или введя начальные символы тега (respo...). Тег ответа можно использовать везде, где поддерживаются переменные среды (URL, заголовки, тело запроса, среды и т. д.).

Ссылка на свойство id созданного ресурса из другого запроса. Затем щелкните тег, чтобы выбрать запрос и указать желаемые параметры. Откроется диалоговое окно, в котором вы можете настроить тег.

{:.alert .alert-primary}
**Примечание**: Используйте этот тег внутри переменной среды, чтобы предотвратить дублирование усилий

Теперь вы можете настроить параметры тега и посмотреть, какой будет результат, в разделе диалогового окна «Просмотр в реальном времени».

{:.alert .alert-primary}
**Примечание**: Значение динамически извлекается из последнего успешного ответа на указанный запрос.

Данные могут быть извлечены из нескольких частей ответа. Я объясню различия сейчас.

## Типы ссылок на ответы

Есть три типа тегов ответа, каждый для ссылки на отдельную часть ответа.

### Сырое тело запроса

Тип ссылки Raw Body будет ссылаться на все содержимое тела запроса. Это может быть полезно, если вы загружаете что-то в одном запросе, а нужно загрузить в другом.

### Атрибут тела

Тип ссылки Body позволяет извлекать определенные атрибуты из тела ответа. Он позволяет использовать запросы JSONPath или XPath (в зависимости от Content-Type) для извлечения определенных атрибутов из тела ответа.

{:.alert .alert-primary}
**Примечание**: Этот ссылочный тип работает только с ответами JSON или XML

Например, запрос на вход в систему может отвечать объектом JSON, который выглядит как {"auth_token": "secret-token"}. Это позволит вам использовать фильтр JSONPath filter в $.auth_token для ссылки на сам токен в последующем запросе.

### Значение заголовка

Тип ссылки заголовка предназначен для извлечения определенных значений заголовка из ответа, что может быть полезно для ссылки на значения nonce или другую полезную информацию.

## Заключение

HTTP API часто имеют зависимости между конечными точками. Например, после создания ресурса часто требуется использовать этот идентификатор ресурса для его получения или обновления. Тег ответа позволяет удовлетворить эти зависимости и устранить необходимость постоянного копирования и вставки этих значений вручную. Может потребоваться небольшая кривая обучения, но с этими тегами определенно стоит ознакомиться, поскольку они могут сэкономить огромное количество времени в будущем.
